
aed_ioctl.h,1693
#define AED_IOCTL_H2,20
typedef struct child_context 43,1183
} child_context_t;48,1274
typedef struct executive_mem_limit 54,1417
} executive_mem_limit_t;56,1482
struct mmap_args 58,1508
struct cap_info 68,1634
struct spd_info 78,1856
struct cos_thread_info 87,2025
struct spd_sched_info 91,2085
#define AED_PROMOTE_TRUSTED 96,2183
#define AED_DEMOTE_TRUSTED 97,2221
#define AED_TESTING 98,2259
#define AED_GET_REGSTATE 99,2297
#define AED_CTXT_SWITCH 100,2351
#define AED_COPY_MM 101,2405
#define AED_PROMOTE_EXECUTIVE 102,2459
#define AED_SWITCH_MM 103,2515
#define AED_CREATE_MM 104,2569
#define AED_EXECUTIVE_MMAP 105,2607
#define AED_TEST 108,2689
#define AED_CREATE_SPD 110,2745
#define AED_SPD_ADD_CAP 111,2800
#define AED_CREATE_THD 112,2855
#define AED_CAP_CHANGE_ISOLATION 113,2910
#define AED_PROMOTE_SCHED 114,2970
#define AED_EMULATE_PREEMPT 115,3025
#define AED_DEMO_SPDS 116,3080
static inline int aed_open_cntl_fd(129,3316
static inline int cos_create_spd(149,3668
static inline int cos_spd_add_cap(162,3913
static inline int cos_create_thd(175,4168
static inline int cos_promote_to_scheduler(188,4420
static inline int cos_demo_spds(208,4908
static inline int create_new_mm(233,5522
static inline void release_mm(245,5710
static inline int get_new_mm(251,5822
static inline void aed_set_test_value(270,6130
static inline void aed_switch_mm(283,6359
static inline void aed_promote_to_executive(296,6583
static inline void aed_get_reg_state(313,6976
static inline void aed_copy_current_mm(326,7224
static inline void aed_ctxt_switch_ioctl(340,7506
static inline void *aed_mmap(aed_mmap352,7755
static inline int aed_munmap(374,8214

hijack.c,5134
#define MODULE_NAME 43,947
pte_t *shared_region_pte;shared_region_pte67,1766
pgd_t *union_pgd;union_pgd68,1792
struct task_struct *composite_thread composite_thread70,1811
struct mm_struct *composite_union_mm composite_union_mm71,1856
unsigned long jmp_addr 74,1948
unsigned long stub_addr 75,2006
unsigned long saved_ip,76,2035
unsigned long saved_ip, saved_ret_ip;76,2035
unsigned long saved_sp;77,2073
unsigned long return_ip;78,2097
unsigned long saved_cr3;79,2122
struct mm_struct *trusted_mm trusted_mm89,2517
struct mm_struct *current_active_guest current_active_guest96,2829
struct pt_regs *user_level_regs;user_level_regs97,2876
struct pt_regs trusted_regs;98,2909
unsigned long trusted_mem_limit;99,2938
unsigned long trusted_mem_size;100,2971
#define MAX_ALLOC_MM 103,3005
struct mm_struct *guest_mms[guest_mms104,3029
static void init_guest_mm_vect(106,3074
static int aed_find_empty_mm_handle(117,3201
static inline struct mm_struct *aed_get_mm(aed_get_mm130,3360
static inline int aed_replace_mm(143,3764
static int aed_allocate_mm(159,4030
static int aed_free_mm(189,4496
int spd_free_mm(203,4844
static void remove_all_guest_mms(231,5488
#define printkd(246,5666
#define printkd(248,5722
int meas_copy_trusted_to_mm,263,6170
int meas_copy_trusted_to_mm, meas_write_regs_to_user,263,6170
int meas_copy_trusted_to_mm, meas_write_regs_to_user, meas_restore_exec_regs;263,6170
int meas_get_guest_mm,264,6248
int meas_get_guest_mm, meas_save_exec_regs,264,6248
int meas_get_guest_mm, meas_save_exec_regs, meas_restore_guest_regs,264,6248
	meas_copynclr_exec_reg,265,6318
	meas_copynclr_exec_reg, meas_switch_pgtbls,265,6318
	meas_copynclr_exec_reg, meas_switch_pgtbls, meas_flush_exec;265,6318
static void register_measurements(267,6381
static void deregister_measurements(280,7138
#define register_measurements(293,7671
#define deregister_measurements(294,7703
#define start_measurement(295,7737
#define stop_measurement(296,7768
static inline struct pt_regs* get_user_regs(350,9433
static inline struct pt_regs* get_user_regs_thread(464,13779
static inline int write_regs_to_user(470,13988
static inline int save_user_regs_to_kern(484,14391
#define HPAGE_SHIFT	495,14665
#define HPAGE_SIZE	496,14688
#define HPAGE_MASK	497,14730
static inline void pte_clrglobal(499,14770
static inline pte_t *lookup_address_mm(lookup_address_mm510,15079
static inline void set_trusted_as_nonglobal(535,15607
static inline void copy_pgd_range(557,16082
static inline void copy_trusted_to_mm(575,16616
static inline void copy_and_clear_trusted(614,17816
#define flush_all(645,18749
#define my_load_cr3(646,18790
#define flush_executive(647,18867
void show_registers(650,18931
#define show_registers(667,19625
void module_switch_to_executive(679,19921
static inline void print_pte_info(755,21885
#define print_pte_info(772,22258
long module_switch_to_child(775,22295
void prevent_executive_copying_on_fork(932,26834
static int aed_ioctl(982,28560
void mem_mapping_syscall(1596,44898
#define NFAULTS 1601,44952
int fault_ptr 1602,44972
struct fault_info 1603,44991
} faults[faults1606,45090
static void cos_handle_page_fault(1609,45158
struct my_desc_struct 1651,46271
#define _set_gate(1658,46480
static void set_trap_gate(1671,46875
static inline unsigned long decipher_descriptor_address(1677,47038
static inline unsigned long change_page_fault_handler(1686,47319
	struct desc_ptr 1693,47569
#define BUCKET_ORDER 1743,49322
#define BUCKET_MASK 1744,49346
#define BUCKET_HASH(1745,49394
#define NUM_BUCKETS 1746,49460
static unsigned long fault_addrs[fault_addrs1748,49519
int main_page_fault_interposition(1755,49712
struct mm_struct* module_page_fault(1889,53490
vaddr_t kern_pgtbl_mapping;1906,54012
struct mm_struct *kern_mm;kern_mm1907,54040
int kern_handle;1908,54067
void *cos_alloc_page(cos_alloc_page1913,54117
void cos_free_page(1922,54250
void *va_to_pa(va_to_pa1932,54526
void *pa_to_va(pa_to_va1937,54582
static inline pte_t *pgtbl_lookup_address(pgtbl_lookup_address1942,54638
void pgtbl_print_tree(1964,55101
int pgtbl_add_entry(1980,55481
phys_addr_t pgtbl_rem_ret(1997,55964
vaddr_t pgtbl_vaddr_to_kaddr(2010,56218
int pgtbl_entry_absent(2036,56893
unsigned long get_valid_pgtbl_entry(2043,57066
void print_valid_pgtbl_entries(2058,57299
void zero_pgtbl_range(2071,57567
void copy_pgtbl_range(2085,57978
void copy_pgtbl_range_nocheck(2102,58508
void copy_pgtbl(2113,58908
void switch_host_pg_tbls(2123,59215
static struct timer_list timer;2149,59862
#define NUM_NET_BRANDS 2156,60141
static void timer_interrupt(2161,60336
static void register_timers(2284,64642
static void deregister_timers(2293,64779
void thd_publish_data_page(2303,64954
void switch_thread_data_page(2317,65368
static int aed_open(2339,66009
#define MAGIC_VAL_TEST 2428,69419
static int aed_release(2451,69888
	#define PER_ROW 2517,71695
static struct file_operations proc_aed_fops 2547,72600
static int make_proc_aed(2555,72820
static int asym_exec_dom_init(2570,73109
static void asym_exec_dom_exit(2608,74156

inv.c,3241
unsigned int shared_region_page[1024] PAGE_ALIGNED;23,620
unsigned int shared_data_page[1024] PAGE_ALIGNED;24,672
static inline struct shared_user_data *get_shared_data(get_shared_data26,723
#define COS_SYSCALL 31,841
static unsigned long cycle_cnt;38,1059
void ipc_init(40,1092
static inline void open_spd(49,1233
static inline void switch_pg_tbls(57,1417
static inline void open_close_spd(67,1583
static inline void open_close_spd_ret(74,1727
static void print_stack(83,2001
void print_regs(95,2417
struct inv_ret_struct 107,2841
COS_SYSCALL vaddr_t ipc_walk_static_cap(118,3128
COS_SYSCALL struct thd_invocation_frame *pop(pop233,7260
COS_SYSCALL int cos_syscall_void(277,8675
struct thread *ready_boot_thread(ready_boot_thread285,8848
void switch_thread_context(310,9389
COS_SYSCALL int cos_syscall_resume_return_cont(345,10278
void initialize_sched_info(434,13045
static inline void copy_sched_info_structs(466,13877
void copy_sched_info(489,14431
COS_SYSCALL int cos_syscall_create_thread(503,14903
COS_SYSCALL struct pt_regs *cos_syscall_switch_thread_cont(cos_syscall_switch_thread_cont585,17566
COS_SYSCALL void cos_syscall_kill_thd_cont(798,24321
static struct thread *upcall_setup(upcall_setup806,24458
static struct thread *upcall_execute(upcall_execute825,24923
static struct pt_regs *brand_execution_completion(brand_execution_completion841,25397
COS_SYSCALL struct thread *cos_syscall_brand_upcall_cont(cos_syscall_brand_upcall_cont932,28459
static inline struct thread* verify_brand_thd(1020,31710
static void print_thd_sched_structs(1040,32260
COS_SYSCALL int cos_syscall_brand_cntl(1057,32785
struct thread *cos_timer_brand_thd;cos_timer_brand_thd1119,34307
#define NUM_NET_BRANDS 1120,34343
int active_net_brands 1121,34368
struct cos_brand_info cos_net_brand[cos_net_brand1122,34395
struct cos_net_callbacks *cos_net_fns cos_net_fns1123,34448
int cos_net_try_brand(1125,34495
void cos_net_register(1132,34617
void cos_net_deregister(1138,34750
static int brand_get_packet(1145,34866
COS_SYSCALL int cos_syscall_brand_wire(1190,35808
static int verify_trust(1239,37059
COS_SYSCALL int cos_syscall_upcall_cont(1264,37671
static int update_evt_list(1334,39794
static inline void update_thd_evt_state(1376,41158
static inline void update_thd_evt_cycles(1399,41664
void update_sched_evts(1420,42280
static inline int most_common_sched_depth(1456,43174
int brand_higher_urgency(1500,44653
struct thread *brand_next_thread(brand_next_thread1545,45956
static struct thread *brand_term_find_run_preempted(brand_term_find_run_preempted1620,48760
struct thread *brand_return_next_thd(brand_return_next_thd1705,51286
COS_SYSCALL int cos_syscall_sched_cntl(1777,53426
static int mpd_split_composite_populate(1928,57814
static int mpd_split(1986,59410
static inline struct composite_spd *get_spd_to_subordinate(get_spd_to_subordinate2069,61677
static struct composite_spd *mpd_merge(mpd_merge2098,63059
struct spd *t1 t12146,64487
static int mpd_state 2148,64543
COS_SYSCALL int cos_syscall_mpd_cntl(2150,64570
COS_SYSCALL int cos_syscall_mmap_cntl(2327,68827
COS_SYSCALL int cos_syscall_print(2391,70388
void *cos_syscall_tbl[cos_syscall_tbl2402,70642

ipc.S,1296
kernel_ipc_syscall:kernel_ipc_syscall31,792
.globl 43,1043
.align 44,1069
composite_call_ipc:composite_call_ipc45,1079
.globl 84,2176
.align 85,2201
composite_ret_ipc:composite_ret_ipc86,2211
ipc_ret_slowpath:ipc_ret_slowpath105,2828
.globl 113,2998
.align 114,3018
ipc_ret_err:ipc_ret_err115,3028
.globl 119,3156
.align 120,3189
cos_syscall_resume_return:cos_syscall_resume_return121,3199
.globl 135,3656
.align 136,3683
syscall_resume_err:syscall_resume_err137,3693
.globl 147,3965
.align 148,3997
cos_syscall_brand_upcall:cos_syscall_brand_upcall149,4007
.globl 186,5158
.align 187,5191
cos_syscall_switch_thread:cos_syscall_switch_thread188,5201
.align 230,6510
ret_from_preemption_getregs:ret_from_preemption_getregs231,6519
ret_from_preemption:ret_from_preemption234,6633
.align 253,6983
.globl 254,6992
cos_switch_error:cos_switch_error255,7016
.globl 259,7068
.align 260,7096
cos_syscall_kill_thd:cos_syscall_kill_thd261,7106
.globl 267,7190
.align 268,7216
cos_syscall_upcall:cos_syscall_upcall269,7226
.globl 293,7706
.align 294,7736
composite_make_syscall:composite_make_syscall295,7746
.align 313,8307
composite_call_err:composite_call_err314,8317
.globl 326,8614
.align 327,8640
composite_ret_err:composite_ret_err328,8650

asym_exec_dom.h,171
#define HIJACK_SWITCH_TO_GUEST_ID 4,53
#define TIF_VIRTUAL_SYSCALL 5,92
#define _TIF_VIRTUAL_SYSCALL	6,189
#define TIF_HIJACK_ENV 7,243
#define _TIF_HIJACK_ENV 8,326

kern_entry.S,850
then 8,205
registers 9,268
stack. 10,330
next 12,455
back 13,517
EBX	17,579
ECX	18,591
EDX	19,603
ESI	20,615
EDI	21,627
EBP	22,639
EAX	23,651
DS	24,663
ES	25,674
ORIG_EAX	26,685
EIP	27,701
CS	28,713
EFLAGS	29,724
OLDESP	30,739
OLDSS	31,754
CF_MASK	33,769
TF_MASK	34,791
IF_MASK	35,813
DF_MASK	36,835
NT_MASK	37,858
VM_MASK	38,880
.globl 76,1528
default_page_fault_handler:default_page_fault_handler77,1562
.globl 79,1600
sysenter_addr:sysenter_addr80,1621
.globl 82,1646
temp_esp_storage:temp_esp_storage83,1670
asym_exec_domain_child_executive:asym_exec_domain_child_executive89,1715
asym_exec_domain_executive_child:asym_exec_domain_executive_child119,2146
hijack_checks:hijack_checks154,2843
normal_syscall:normal_syscall218,4881
not_composite_pf:not_composite_pf252,5628
normal_pf:normal_pf263,5860

user_prototype/include/asm_ipc_defs.h,227
#define IPRETURN 5,135
#define SFRAMEUSR 8,209
#define SFRAMESP 9,229
#define SFRAMEIP 10,248
#define SIZEOFUSERCAP 14,366
#define INVFN 15,391
#define ENTRYFN 16,407
#define INVOCATIONCNT 17,425
#define CAPNUM 18,449

user_prototype/include/ref_count.h,72
#define REF_COUNT_H2,20
typedef unsigned short int ref_counter_t;4,41

user_prototype/include/thread.h,379
#define THREAD_H7,70
#define MAX_SERVICE_DEPTH 22,406
#define MAX_NUM_THREADS 23,435
#define THREAD_SIZE 24,461
typedef struct thd_invocation_frame 32,616
} HALF_CACHE_ALIGN;41,946
typedef struct thread 49,1229
} CACHE_ALIGN;60,1565
static inline void thd_invocation_push(71,1834
static inline struct thd_invocation_frame *thd_invocation_pop(thd_invocation_pop96,2630

user_prototype/include/spd.h,691
#define SPD_H7,67
#define MAX_NUM_SPDS 30,780
#define MAX_STATIC_CAP 32,865
struct usr_inv_cap 44,1318
} HALF_CACHE_ALIGNED;47,1423
struct usr_cap_stubs 50,1486
struct invocation_cap 60,1706
} CACHE_ALIGNED;69,2072
#define SPD_COMPOSITE 88,2563
#define SPD_FREE 89,2622
#define SPD_DEPRICATED 90,2669
struct spd_poly 99,3028
struct composite_spd 116,3526
} CACHE_ALIGNED;120,3629
struct spd_location 123,3720
struct spd 128,3793
} CACHE_ALIGNED;146,4190
#define SPD_CAP_TBL_PTR 158,4544
#define SPD_CAP_TBL_SZ 159,4570
#define SPD_LOWER_ADDR 160,4596
#define SPD_REGION_SIZE 161,4621
#define CAP_SIZE 164,4649
#define CAP_ENTRY_INST 165,4668
#define CAP_SPD 166,4693

user_prototype/include/cos_types.h,691
#define TYPES_H2,16
#define MNULL 4,33
typedef unsigned long phys_addr_t;11,206
typedef unsigned long vaddr_t;12,241
typedef unsigned int page_index_t;13,272
#define MAX_ISOLATION_LVL_VAL 15,308
#define IL_INV_UNMAP 16,340
#define IL_RET_UNMAP 17,406
#define IL_ST 24,717
#define IL_SDT 25,736
#define IL_AST 26,781
typedef unsigned int isolation_level_t;27,812
typedef struct { volatile unsigned int counter; } atomic_t;29,853
#define LOCK 32,932
#define LOCK 34,961
#define ATOMIC_INIT(37,985
static __inline__ void set_atomic(39,1017
static __inline__ void atomic_inc(52,1237
static __inline__ void atomic_dec(66,1493
static __inline__ int atomic_dec_and_test(82,1823

user_prototype/include/regs.h,27
typedef int gp_regs_t;1,0

user_prototype/include/ipc.h,19
#define IPC_H7,67

user_prototype/include/consts.h,411
#define PAGE_SIZE 6,53
#define PAGE_MASK 7,79
#define PGD_RANGE 8,114
#define PGD_MASK 9,140
#define round_to_page(11,176
#define round_up_to_page(12,217
#define round_to_pgd_page(13,275
#define round_up_to_pgd_page(14,319
#define CACHE_LINE 16,381
#define CACHE_ALIGNED 17,405
#define HALF_CACHE_ALIGNED 18,466
#define INV_STK_START 20,535
#define INV_STK_SIZE 21,575
#define SERVICE_SIZE 23,661

user_prototype/main.c,306
#define ITER 8,98
#define rdtscll(9,116
#define SAME_FILE 71,1301
int spd0_main(74,1346
int spd1_main(119,2346
int spd2_main(132,2516
int spd3_main(141,2639
int spd4_main(150,2819
struct usr_inv_cap *get_user_static_cap_addr(get_user_static_cap_addr157,2913
int main(166,3077
int main(213,4256

user_prototype/thread.c,312
static struct thread threads[threads9,91
static struct thread *thread_freelist_head thread_freelist_head10,138
struct thread *current_thread;current_thread12,220
void thd_init_all(15,253
struct thread *thd_alloc(thd_alloc31,530
void thd_free(51,892
void thd_set_current(59,1014
void thd_init(66,1093

user_prototype/spd.c,437
struct invocation_cap invocation_capabilities[invocation_capabilities11,111
static void spd_init_capabilities(13,175
static short int spd_alloc_capability_range(34,730
static struct spd spds[spds68,1398
static struct spd *spd_freelist_head spd_freelist_head74,1541
static void spd_init_all(76,1588
void spd_init(90,1837
void spd_free(96,1932
struct spd *spd_alloc(spd_alloc105,2079
unsigned int spd_add_static_cap(154,3051

user_prototype/ipc.c,461
void print(13,129
void print_val(19,186
typedef int (*fn_t)fn_t26,266
void *kern_stack;kern_stack27,293
void *kern_stack_addr;kern_stack_addr28,311
struct user_inv_cap *ST_user_caps;ST_user_caps31,388
void ipc_init(33,424
static inline void open_spd(41,568
static inline void open_close_spd(46,632
static int stale_il_or_error(54,753
static void print_stack(60,870
fn_t ipc_walk_static_cap(77,1458
struct thd_invocation_frame *pop(pop138,3516

user_prototype/old/ipc.S,482
.globl 6,84
.align 7,102
client_ipc:client_ipc11,144
.globl 59,1694
.align 60,1716
server_ret_ipc:server_ret_ipc61,1725
error_bad_cap:error_bad_cap83,2110
.globl 91,2270
.align 92,2292
client_marshal:client_marshal93,2301
.globl 102,2485
.align 103,2509
server_unmarshal:server_unmarshal104,2518
.globl 113,2663
.align 114,2689
server_ret_marshal:server_ret_marshal115,2698
.globl 124,2818
.align 125,2846
client_ret_unmarshal:client_ret_unmarshal126,2855

user_prototype/old/asm_ipc.11.29.06.S,521
IPRETURN 5,59
SFRAMEIP 6,128
SFRAMESP 7,142
.globl 14,292
.align 15,314
ipc_invoke_spd:ipc_invoke_spd16,324
.globl 20,382
.align 21,404
client_marshal:client_marshal22,413
.globl 38,667
.align 39,691
server_unmarshal:server_unmarshal40,700
.globl 49,854
.align 50,880
server_ret_marshal:server_ret_marshal51,889
.globl 66,1116
.align 67,1144
client_ret_unmarshal:client_ret_unmarshal68,1153
ipc_syscall:ipc_syscall79,1314
server_inv:server_inv82,1391
.align 102,1704
ret_cap:ret_cap103,1714

user_prototype/tests/hw_measurements.S,1686
.globl 3,34
.align 4,56
call_asym_stub:call_asym_stub5,65
.align 13,190
ret_asym_stub:ret_asym_stub14,199
.globl 25,291
.align 26,313
call_asym_stub:call_asym_stub27,322
.align 34,435
ret_asym_stub:ret_asym_stub35,444
.globl 40,487
.align 41,509
recv_asym_stub:recv_asym_stub42,518
With 46,564
.globl 49,605
.align 50,631
composite_call_ipc:composite_call_ipc51,640
.globl 58,755
.align 59,780
composite_ret_ipc:composite_ret_ipc60,789
.globl 69,892
.align 70,914
call_asym_stub:call_asym_stub71,923
.align 81,1092
call_ret_asym_stub:call_ret_asym_stub82,1101
.globl 89,1181
.align 90,1203
recv_asym_stub:recv_asym_stub91,1212
.align 97,1309
recv_ret_asym_stub:recv_ret_asym_stub98,1318
With 106,1421
.globl 108,1460
.align 109,1486
composite_call_ipc:composite_call_ipc110,1495
.globl 118,1635
.align 119,1660
composite_ret_ipc:composite_ret_ipc120,1669
The 130,1790
.globl 133,1830
.align 134,1852
call_asym_stub:call_asym_stub135,1861
.align 145,2050
call_ret_asym_stub:call_ret_asym_stub146,2059
.globl 153,2140
.align 154,2162
recv_asym_stub:recv_asym_stub155,2171
.align 161,2269
recv_ret_asym_stub:recv_ret_asym_stub162,2278
With 170,2384
.globl 173,2405
.align 174,2431
composite_call_ipc:composite_call_ipc175,2440
.globl 185,2620
.align 186,2645
composite_ret_ipc:composite_ret_ipc187,2654
And 194,2768
secondary 203,2995
.globl 208,3074
.align 209,3096
call_asym_stub:call_asym_stub210,3105
.align 220,3410
call_ret_asym_stub:call_ret_asym_stub221,3419
.globl 228,3563
.align 229,3585
recv_asym_stub:recv_asym_stub230,3594
.align 236,3729
recv_ret_asym_stub:recv_ret_asym_stub237,3738

user_prototype/kern_ipc.S,674
.globl 44,1099
.align 45,1128
SS_ipc_client_marshal:SS_ipc_client_marshal46,1138
.globl 63,1510
.align 64,1545
SS_ipc_client_ret_unmarshal:SS_ipc_client_ret_unmarshal65,1554
.globl 76,1868
.align 77,1899
SS_ipc_server_unmarshal:SS_ipc_server_unmarshal78,1909
.globl 100,2280
.align 101,2309
DS_ipc_client_marshal:DS_ipc_client_marshal102,2319
.globl 119,2695
.align 120,2730
DS_ipc_client_ret_unmarshal:DS_ipc_client_ret_unmarshal121,2739
.globl 132,3057
.align 133,3088
DS_ipc_server_unmarshal:DS_ipc_server_unmarshal134,3098
kernel_ipc_syscall:kernel_ipc_syscall162,3614
server_inv:server_inv165,3698
.align 191,4270
ret_cap:ret_cap192,4280

user_prototype/kern_entry.S,850
then 8,205
registers 9,268
stack. 10,330
next 12,455
back 13,517
EBX	17,579
ECX	18,591
EDX	19,603
ESI	20,615
EDI	21,627
EBP	22,639
EAX	23,651
DS	24,663
ES	25,674
ORIG_EAX	26,685
EIP	27,701
CS	28,713
EFLAGS	29,724
OLDESP	30,739
OLDSS	31,754
CF_MASK	33,769
TF_MASK	34,791
IF_MASK	35,813
DF_MASK	36,835
NT_MASK	37,858
VM_MASK	38,880
.globl 76,1528
default_page_fault_handler:default_page_fault_handler77,1562
.globl 79,1600
sysenter_addr:sysenter_addr80,1621
.globl 82,1646
temp_esp_storage:temp_esp_storage83,1670
asym_exec_domain_child_executive:asym_exec_domain_child_executive89,1715
asym_exec_domain_executive_child:asym_exec_domain_executive_child119,2146
hijack_checks:hijack_checks154,2843
normal_syscall:normal_syscall203,4400
not_composite_pf:not_composite_pf236,5087
normal_pf:normal_pf241,5261

user_prototype/linking/gen_client_stub.c,179
#define STR_SIZE 15,261
char *header header17,284
char *fn_string fn_string53,1216
char *footer footer82,2178
static inline void create_stanza(112,2591
int main(128,2986

user_prototype/linking/cos_loader.c,3725
#define NUM_ATOMIC_SYMBS 38,1218
#define NUM_KERN_SYMBS 39,1247
const char *USER_CAP_TBL_NAME USER_CAP_TBL_NAME41,1292
const char *ST_INV_FN_NAME ST_INV_FN_NAME42,1340
const char *UPCALL_ENTRY_NAME UPCALL_ENTRY_NAME43,1393
const char *SCHED_PAGE_NAME SCHED_PAGE_NAME44,1445
const char *SPD_ID_NAME SPD_ID_NAME45,1502
const char *HEAP_PTR HEAP_PTR46,1547
const char *ATOMIC_USER_DEF[ATOMIC_USER_DEF48,1587
#define CAP_CLIENT_STUB_DEFAULT 60,1883
#define CAP_CLIENT_STUB_POSTPEND 61,1944
#define CAP_SERVER_STUB_POSTPEND 62,1985
#define BASE_SERVICE_ADDRESS 64,2026
#define DEFAULT_SERVICE_SIZE 65,2069
#define LINKER_BIN 67,2112
#define GCC_BIN 68,2145
enum {TEXT_S,TEXT_S75,2327
enum {TEXT_S, RODATA_S,75,2327
enum {TEXT_S, RODATA_S, DATA_S,75,2327
enum {TEXT_S, RODATA_S, DATA_S, BSS_S,75,2327
enum {TEXT_S, RODATA_S, DATA_S, BSS_S, INVSTK_S,75,2327
enum {TEXT_S, RODATA_S, DATA_S, BSS_S, INVSTK_S, MAXSEC_S}MAXSEC_S75,2327
struct sec_info 77,2388
unsigned long ro_start;82,2437
unsigned long data_start;83,2461
unsigned long inv_stk_start;84,2487
char script[script86,2517
char tmp_exec[tmp_exec87,2534
struct sec_info srcobj[srcobj89,2555
struct sec_info ldobj[ldobj90,2589
#define UNDEF_SYMB_TYPE 92,2623
#define EXPORTED_SYMB_TYPE 93,2651
#define MAX_SYMBOLS 94,2682
#define MAX_TRUSTED 95,2705
#define MAX_SYMB_LEN 96,2728
typedef int (*observer_t)observer_t98,2753
struct symb 102,2827
struct symb_type 109,2935
struct service_symbs 116,3039
static unsigned long getsym(130,3311
static void print_syms(159,4013
static void findsections(200,5411
static int calc_offset(221,5871
static int calculate_mem_size(237,6109
static void emit_address(255,6479
static void emit_section(260,6588
static int genscript(274,6990
static void run_linker(308,7742
#define bfd_sect_size(316,7934
int set_object_addresses(318,8016
vaddr_t get_symb_address(361,9254
static int load_service(373,9464
static int add_service_dependency(567,15012
static int initialize_service_symbs(581,15271
static struct service_symbs *alloc_service_symbs(alloc_service_symbs593,15524
static void free_symbs(609,15829
static void free_service_symbs(618,15959
static int obs_serialize(628,16116
static int for_each_symb_type(657,16755
static int obj_serialize_symbols(701,17821
static inline void print_symbs(729,18375
static void print_objs_symbs(740,18533
static inline int service_processed(758,18847
static inline void add_kexport(770,19059
static void add_kernel_exports(788,19557
static struct service_symbs *prepare_service_symbs(prepare_service_symbs816,20399
struct service_symbs *find_symbol_exporter(find_symbol_exporter851,21098
static int verify_dependency_completeness(883,21996
static int rec_verify_dag(925,22960
static int verify_dependency_soundness(961,23876
static inline struct service_symbs *get_service_struct(get_service_struct983,24245
static int deserialize_dependencies(1004,24720
static char *strip_prepended_path(strip_prepended_path1063,25788
static void gen_stubs_and_link(1085,26208
static int load_all_services(1169,28318
static void print_kern_symbs(1202,29017
int create_invocation_cap(1302,31453
static struct symb *spd_contains_symb(spd_contains_symb1363,33268
static int create_spd_capabilities(1376,33542
struct spd_info *create_spd(create_spd1422,35049
void make_spd_scheduler(1498,37358
static struct service_symbs *find_obj_by_name(find_obj_by_name1519,37966
#define MAX_SCHEDULERS 1532,38150
static void setup_kernel(1534,38176
#define ITER 1600,39914
#define rdtscll(1601,39929
static inline void print_usage(1614,40140
#define STUB_PROG_LEN 1624,40375
void segv_handler(1631,40547
int main(1650,41104

user_prototype/linking/c/c0.c,92
#define ITER 9,205
int t(11,225
int other(16,256
int other(17,299
int spd0_main(34,512

user_prototype/linking/c/c1.c,43
int spd1_call4(4,57
int spd1_main(11,146

user_prototype/linking/c/c2.c,69
int spd2_main(4,57
int spd2_other(9,121
int spd2_other_one(14,172

user_prototype/linking/c/c3.c,19
int spd3_main(1,0

user_prototype/linking/c/c4.c,43
int spd4_main(4,56
int spd4_noarg(10,130

user_prototype/linking/c/c4_cyc.c,20
int spd4_main(3,29

user_prototype/linking/c/cos_component.h,31
#define prevent_tail_call(1,0

user_prototype/linking/t/cos_component.h,1306
#define COS_COMPONENT_H9,178
void *cos_heap_ptr;cos_heap_ptr16,382
#define cos_syscall_asm 59,2559
#define cos_syscall_clobber	70,3000
#define cos_syscall_0(74,3079
#define cos_syscall_1(83,3448
#define cos_syscall_2(92,3830
#define cos_syscall_3(101,4243
static inline int cos_mmap_cntl(126,5627
static inline int cos_brand_upcall(133,5879
static inline int cos_switch_thread(152,6736
static inline void cos_next_thread(178,7859
static inline unsigned short int cos_get_thd_id(185,8043
static inline void *cos_get_arg_region(cos_get_arg_region192,8192
static inline long cos_spd_id(199,8333
static inline void *cos_get_heap_ptr(cos_get_heap_ptr204,8399
static inline void cos_set_heap_ptr(209,8469
#define COS_EXTERN_FN(214,8544
static inline long cos_cmpxchg(216,8589
static inline void *cos_memcpy(cos_memcpy230,8878
static inline void *cos_memset(cos_memset251,9368
#define COS_ARGREG_SZ 264,9628
#define COS_MAX_ARG_SZ 265,9660
#define COS_IN_ARGREG(266,9688
#define ALIGN(271,9840
struct cos_argreg_extent 288,10167
static inline void cos_argreg_init(292,10218
static inline void *cos_argreg_alloc(cos_argreg_alloc299,10335
static inline int cos_argreg_free(317,10780
#define prevent_tail_call(331,11119
#define rdtscll(332,11188
#define COS_FIRST_ARG 334,11253

user_prototype/linking/t/comp1.c,292
const char comp1str[comp1str4,47
static inline int find_size(10,160
int blah 21,298
volatile int turn 22,312
int spd1_fn(23,335
#define LOWER 51,711
#define UPPER 52,727
volatile unsigned short int curr 54,744
void c1_yield(56,783
void cos_upcall_fn(63,919
void symb_dump(79,1173

user_prototype/linking/t/cos_scheduler.h,1676
#define COS_SCHEDULER_H11,267
static inline int cos_sched_lock_take(21,486
static inline int cos_sched_lock_release(47,1101
static inline int cos_switch_thread_release(73,1758
#define THD_BLOCKED 94,2416
#define THD_READY 95,2440
#define THD_FREE 96,2464
#define THD_GRP 97,2488
#define THD_MEMBER 98,2548
#define THD_UC_ACTIVE 99,2608
#define THD_UC_READY 100,2635
#define sched_thd_free(102,2663
#define sched_thd_grp(103,2720
#define sched_thd_member(104,2776
#define sched_thd_ready(105,2835
#define sched_thd_blocked(106,2893
#define sched_thd_event(107,2953
#define SCHED_NUM_THREADS 109,3031
#define INIT_LIST(111,3074
#define ADD_LIST(114,3150
#define REM_LIST(120,3315
#define FIRST_LIST(125,3479
#define LAST_LIST(128,3547
#define EMPTY_LIST(131,3615
struct sched_accounting 134,3681
struct sched_metric 139,3776
struct sched_thd 143,3841
static inline struct sched_accounting *sched_get_accounting(sched_get_accounting169,4695
static inline struct sched_metric *sched_get_metric(sched_get_metric176,4841
typedef void (*sched_evt_visitor_t)sched_evt_visitor_t185,5035
static inline struct sched_thd *sched_evt_to_thd(sched_evt_to_thd190,5374
static inline void sched_set_thd_urgency(197,5537
static inline struct sched_thd *sched_get_mapping(sched_get_mapping214,5865
static inline struct sched_thd *sched_get_current(sched_get_current225,6121
static inline int sched_add_mapping(236,6312
static inline void sched_rem_mapping(248,6537
static inline int sched_is_grp(255,6680
static inline struct sched_thd *sched_get_members(sched_get_members269,6894
static inline struct sched_thd *sched_get_grp(sched_get_grp277,7081

user_prototype/linking/t/comp2.c,821
void nothing(6,97
static inline vaddr_t get_stack_addr(13,197
static unsigned short int thd_id 19,356
volatile static unsigned short int curr_thd,20,422
volatile static unsigned short int curr_thd, other_thd;20,422
volatile static int nothing_var 21,478
void yield(23,516
void thread_tramp(42,814
#define LOWER 54,949
#define UPPER 55,965
void run_thds(57,982
int spd2_fn(64,1103
#define ITER 100,1890
int run_demo(102,1912
#define OTHER_THD(114,2077
volatile static int race_val;115,2117
#define SPIN 116,2147
int fact(119,2200
int test_locks_fn(124,2285
int test_locks(152,3007
void cos_upcall_fn(164,3318
int test_brands(200,3974
#define SZ 213,4194
#define INC 214,4209
#define NP 215,4236
int test_mmapping(219,4385
int test_print(270,5623
int sched_init(278,5729
void symb_bag(295,5983

user_prototype/linking/t/comp0.c,74
int nothing 5,58
#define ITER 7,76
int spd0_main(9,97
void bag(22,258

user_prototype/linking/t/cos_component.c,155
long cos_this_spd_id 15,337
void *cos_heap_ptr cos_heap_ptr16,363
struct cos_sched_data_area cos_sched_notifications 17,390
void cos_upcall_fn(24,616

user_prototype/linking/t/comp3.c,57
#define ITER 3,28
void bar(7,158
void symb_bin(26,451

user_prototype/linking/t/comp4.c,32
int keeper;4,72
void foo(6,85

user_prototype/linking/t/s_stub.S,181
.globl 6,72
nil:nil7,83
.align 9,97
.globl 10,107
cos_static_stack:cos_static_stack11,131
.text	16,177
.globl 20,356
.type 21,372
.align 22,399
spd1_inv:spd1_inv23,409

user_prototype/linking/t/c_stub.S,526
.globl 5,66
.type 6,95
.align 7,135
SS_ipc_client_marshal:SS_ipc_client_marshal8,145
.globl 28,644
.type 29,678
.align 30,723
SS_ipc_client_marshal_args:SS_ipc_client_marshal_args31,733
.globl 51,1149
.align 52,1184
SS_ipc_client_ret_unmarshal:SS_ipc_client_ret_unmarshal53,1193
.globl 70,1448
.type 71,1486
.align 72,1535
SS_ipc_client_marshal_saveregs:SS_ipc_client_marshal_saveregs73,1545
.globl 86,1892
.align 87,1936
SS_ipc_client_ret_unmarshal_saveregs:SS_ipc_client_ret_unmarshal_saveregs88,1945

user_prototype/linking/t/s_stub1.S,82
.text	6,78
.globl 10,257
.type 11,273
.align 12,300
spd1_inv:spd1_inv13,310

user_prototype/linking/t/t.S,72
.long 2,6
hello:hello3,14
.string 4,21
.globl 7,52
main:main8,64

user_prototype/linking/t/c_stub-shared_stack.S,184
.globl 6,67
.type 7,96
.align 8,136
SS_ipc_client_marshal:SS_ipc_client_marshal9,146
.globl 22,459
.align 23,494
SS_ipc_client_ret_unmarshal:SS_ipc_client_ret_unmarshal24,503

user_prototype/linking/t/s_stub2.S,320
.text	6,78
.globl 10,257
.type 11,276
.align 12,306
spd2_fn_inv:spd2_fn_inv13,316
.globl 26,492
.type 27,509
.align 28,537
yield_inv:yield_inv29,547
.globl 42,718
.type 43,737
.align 44,767
nothing_inv:nothing_inv45,777
.globl 59,955
.type 60,977
.align 61,1010
sched_init_inv:sched_init_inv62,1020

user_prototype/linking/t/s_stub-shared_stack.S,94
.globl 7,220
.type 8,236
.align 9,263
spd1_inv:spd1_inv10,273
.rep 31,614
.long 32,623

user_prototype/linking/t/print_comp.c,131
#define MAX_LEN 5,67
char foo[foo7,87
int validate_format(10,155
int printstr(23,379
int print_vals(45,865
int main(56,1104

user_prototype/linking/t/s_stubprint.S,172
.text	6,78
.globl 10,257
.type 11,277
.align 12,308
printstr_inv:printstr_inv13,318
.globl 27,504
.type 28,526
.align 29,559
print_vals_inv:print_vals_inv30,569

user_prototype/linking/t/cos_asm_synchronization.S,393
.globl 24,710
.type 25,734
.align 26,768
cos_atomic_user1:cos_atomic_user127,778
locked:locked42,1076
commit:commit45,1149
.globl 50,1366
cos_atomic_user1_end:cos_atomic_user1_end51,1394
.globl 60,1579
.type 61,1604
.align 62,1638
cos_atomic_user2:cos_atomic_user263,1648
no_contention:no_contention79,1930
.globl 82,2051
cos_atomic_user2_end:cos_atomic_user2_end83,2079

user_prototype/linking/t/cos_asm_upcall.S,1024
.align 15,257
.globl 16,267
nil:nil17,278
.globl 22,326
cos_static_stack:cos_static_stack23,350
cos_sched_notifications:cos_sched_notifications30,444
.globl 39,591
cos_sched_notifications:cos_sched_notifications40,622
.globl 47,686
.type 48,710
.align 49,745
cos_upcall_entry:cos_upcall_entry50,755
.weak 69,1115
.type 70,1140
.align 71,1176
cos_atomic_cmpxchg:cos_atomic_cmpxchg72,1186
cos_atomic_cmpxchg_end:cos_atomic_cmpxchg_end78,1367
.weak 84,1462
.type 85,1485
cos_atomic_user1:cos_atomic_user186,1519
.weak 87,1537
cos_atomic_user1_end:cos_atomic_user1_end88,1564
.weak 89,1586
.type 90,1609
cos_atomic_user2:cos_atomic_user291,1643
.weak 92,1661
cos_atomic_user2_end:cos_atomic_user2_end93,1688
.weak 94,1710
.type 95,1733
cos_atomic_user3:cos_atomic_user396,1767
.weak 97,1785
cos_atomic_user3_end:cos_atomic_user3_end98,1812
.weak 99,1834
.type 100,1857
cos_atomic_user4:cos_atomic_user4101,1891
.weak 102,1909
cos_atomic_user4_end:cos_atomic_user4_end103,1936

user_prototype/linking/t/s_stub3.S,80
.text	6,78
.globl 11,258
.type 12,273
.align 13,299
bar_inv:bar_inv14,309

user_prototype/linking/t/s_stub4.S,80
.text	6,78
.globl 11,258
.type 12,273
.align 13,299
foo_inv:foo_inv14,309

user_prototype/linking/t/cos_scheduler.c,703
int cos_sched_process_events(6,140
void cos_sched_set_evt_urgency(77,1548
struct sched_thd *sched_thd_map[sched_thd_map115,2342
struct sched_thd sched_thds[sched_thds116,2394
struct sched_thd sched_grps[sched_grps117,2443
struct sched_thd *sched_map_evt_thd[sched_map_evt_thd118,2491
void sched_init_thd(120,2545
short int sched_alloc_event(133,2885
void sched_ds_init(163,3573
struct sched_thd *sched_alloc_thd(sched_alloc_thd189,4080
struct sched_thd *sched_alloc_upcall_thd(sched_alloc_upcall_thd206,4362
void sched_make_grp(218,4552
struct sched_thd *sched_alloc_grp(sched_alloc_grp228,4775
void sched_free_thd(250,5134
void sched_add_grp(258,5239
void sched_rem_grp(273,5565

user_prototype/linking/t/cos_list.h,109
#define COS_LIST_H2,19
typedef struct list_ptr 15,456
} list_ptr_t;17,502
#define LIST_OPS_CREATE(19,517

user_prototype/linking/t/cos_alloc.c,1290
#define PAGE_SIZE 20,418
struct free_page 27,551
struct free_page page_list 31,611
#define MAP_FAILED 40,909
#define NULL 44,961
} __alloc_t;50,1040
#define BLOCK_START(52,1054
#define BLOCK_RET(53,1110
#define MEM_BLOCK_SIZE	55,1165
#define PAGE_ALIGN(56,1198
#define REGPARM(59,1294
#define REGPARM(61,1347
static inline REGPARM(64,1374
/*static inline*/ REGPARM(79,1790
static __alloc_t* __small_mem[__small_mem91,2134
#define __SMALL_NR(93,2169
#define __MIN_SMALL_SIZE	95,2214
#define __MAX_SMALL_SIZE	96,2274
#define GET_SIZE(98,2333
#define FIRST_SMALL(100,2390
static inline int __ind_shift(102,2460
static size_t REGPARM(104,2532
static void __small_free(114,2816
static void* REGPARM(127,3143
static void _alloc_libc_free(161,3801
void free(174,4134
static __alloc_t zeromem[zeromem177,4229
static void* _alloc_libc_malloc(180,4266
void* malloc(211,5058
void *alloc_page(alloc_page216,5161
void free_page(233,5373
void* __libc_calloc(252,5657
void* calloc(260,5856
void* __libc_realloc(263,5991
void* realloc(311,7077
#define ITER 319,7254
#define PTRS_LIVE 320,7274
#define SIZE_LB 321,7296
#define SIZE_UB 322,7314
#define SIZE_GET 323,7335
int find_ptr(330,7472
void malloc_rand(342,7661
void free_rand(365,8053
int main(392,8496

user_prototype/linking/t/cos_synchronization.c,116
void cos_lock_take(17,629
void cos_lock_release(42,1372
int cos_lock_init(60,1901
void cos_lock_cleanup(71,2093

user_prototype/linking/t/cos_synchronization.h,56
#define COS_SYNCHONIZATION_H9,183
} cos_lock_t;15,381

user_prototype/linking/t/mem_man.c,308
struct mem_cell 10,182
static struct mem_cell cells[cells15,281
static inline long cell_index(17,328
static inline struct mem_cell *find_unused(find_unused22,402
static inline struct mem_cell *find_cell(find_cell34,582
vaddr_t mman_get_page(53,922
void mman_release_page(76,1299
void dump(89,1530

user_prototype/linking/t/s_stubmm.S,196
.text	6,78
.globl 11,258
.type 12,283
.align 13,319
mman_get_page_inv:mman_get_page_inv14,329
.globl 29,562
.type 30,591
.align 31,631
mman_release_page_inv:mman_release_page_inv32,641

user_prototype/linking/t/cos_bitmap.h,180
#define COS_BITMAP_H9,175
#define INT_SIZE 13,220
} bitmap_t;17,286
#define CREATE_STATIC_BITMAP(19,299
static inline int bit_is_set(23,450
static inline void bit_set(35,702

user_prototype/linking/t/cos_alloc.h,59
#define COS_ALLOC_H2,20
typedef unsigned int size_t;4,41

user_prototype/linking/t/lock.c,517
struct blocked_thds 12,238
struct meta_lock 17,320
static unsigned long lock_id 26,467
static struct meta_lock *locks;locks28,541
static inline struct meta_lock *lock_find(lock_find30,574
static struct meta_lock *lock_alloc(lock_alloc45,820
static void lock_free(70,1260
static inline void update_curr_gen(82,1447
static inline int is_locked_gen(94,1884
int lock_component_take(103,2196
int lock_component_release(141,3290
unsigned long lock_component_alloc(163,3684
void lock_component_free(172,3824

user_prototype/linking/t/print.h,145
#define PRINT_H2,16
static inline void strcpn(6,61
static inline int strlen(19,254
#define ARG_STRLEN 27,347
static inline int print(29,427

user_prototype/linking/t/fp_rr.c,1612
#define NUM_PRIOS 5,80
#define LOWEST_PRIO 6,100
static volatile unsigned long ticks 8,135
static struct sched_thd *timer,timer10,177
static struct sched_thd *timer, *init;init10,177
struct sched_thd blocked;11,216
struct sched_thd upcall_deactive;12,242
struct prio_list 13,276
} priorities[priorities15,323
static inline void fp_add_thd(17,349
static inline void fp_add_evt_thd(33,767
static inline void fp_change_prio_runnable(47,1156
static inline void fp_move_end_runnable(62,1531
static inline void fp_block_thd(69,1687
static inline void fp_resume_thd(79,1908
static void fp_activate_upcall(89,2112
static void fp_deactivate_upcall(97,2304
static struct sched_thd *fp_get_highest_prio(fp_get_highest_prio105,2526
static struct sched_thd *fp_get_second_highest_prio(fp_get_second_highest_prio128,2945
static inline void fp_requeue_highest(166,3799
static void evt_callback(172,3939
static inline struct sched_thd *fp_schedule(fp_schedule196,4545
#define RUNTIME_SEC 207,4786
#define TIMER_FREQ 208,4808
#define CYC_PER_USEC 209,4831
void fp_timer_tick(211,4858
static void fp_event_completion(235,5379
typedef void (*crt_thd_fn_t)crt_thd_fn_t252,5826
static void fp_idle_loop(254,5869
static void fp_yield(259,5920
#define DELAY 280,6305
volatile long bar 281,6325
static void fp_fresh_thd(282,6348
int sched_wakeup(298,6580
int sched_block(343,7395
static struct sched_thd *sched_setup_thread(sched_setup_thread387,8204
static struct sched_thd *sched_setup_upcall_thread(sched_setup_upcall_thread403,8569
int sched_init(422,9080
void cos_upcall_fn(462,9997

user_prototype/linking/t/cos_debug.h,134
#define PRINT_FN 5,49
#define DEBUG6,72
#define assert(10,170
#define printd(12,351
#define assert(14,405
#define printd(15,423

user_prototype/linking/t/cos_asm_scheduler.S,580
.globl 13,296
.type 14,320
.align 15,354
cos_atomic_user1:cos_atomic_user116,364
.globl 23,574
cos_atomic_user1_end:cos_atomic_user1_end24,602
.globl 33,742
.type 34,767
.align 35,801
cos_atomic_user2:cos_atomic_user236,811
.globl 39,866
cos_atomic_user2_end:cos_atomic_user2_end40,894
.globl 43,922
.type 44,946
cos_atomic_user3:cos_atomic_user345,980
.globl 46,998
cos_atomic_user3_end:cos_atomic_user3_end47,1026
.globl 48,1048
.type 49,1072
cos_atomic_user4:cos_atomic_user450,1106
.globl 51,1124
cos_atomic_user4_end:cos_atomic_user4_end52,1152

user_prototype/linking/t/s_stubfprr.S,96
.text	13,232
.globl 18,413
.type 19,435
.align 20,468
sched_init_inv:sched_init_inv21,478

user_prototype/linking/t/cos_asm_stacks.h,64
#define COS_ASM_STACKS_H2,25
#define COS_ASM_GET_STACK 11,367

user_prototype/linking/ST_test/out.S,389
.globl 2,6
.align 3,18
blah:blah4,28
.globl 11,130
.align 12,158
ST_direct_invocation:ST_direct_invocation13,168
.align 20,330
.globl 21,340
ST_user_caps:ST_user_caps22,360
.rep 23,374
.long 24,381
ST_user_caps_end:ST_user_caps_end26,395
.section 27,413
.globl 28,431
ST_invocation_stack:ST_invocation_stack29,458
.globl 31,485
ST_inv_stk_size:ST_inv_stk_size32,508

user_prototype/linking/ST_test/out.c,111
#define ITER 5,60
#define rdtscll(6,79
int foo(9,152
void bar(15,203
void set_cap(36,567
int main(47,827

user_prototype/linking/ST_test/out.h,171
typedef unsigned int vaddr_t;1,0
#define CACHE_LINE 2,30
#define CACHE_ALIGNED 3,54
#define HALF_CACHE_ALIGN 4,115
struct usr_inv_cap 5,181
} HALF_CACHE_ALIGN;8,286

spd.c,2129
struct spd *virtual_spd_layout[virtual_spd_layout20,511
int virtual_namespace_alloc(22,558
struct spd *virtual_namespace_query(virtual_namespace_query41,1064
struct invocation_cap invocation_capabilities[invocation_capabilities49,1200
int cap_is_free(51,1264
static inline void cap_set_free(61,1418
static void spd_init_capabilities(66,1520
static short int spd_alloc_capability_range(88,2086
static inline void cap_set_usr_cap(125,2819
static inline struct usr_inv_cap *cap_get_usr_cap(cap_get_usr_cap137,3177
isolation_level_t cap_change_isolation(152,3435
static struct spd spds[spds214,5279
static struct spd *spd_freelist_head spd_freelist_head220,5422
static void spd_init_all(222,5468
void spd_init(241,5837
int spd_is_free(248,5961
void spd_free(255,6155
void spd_free_all(277,6675
struct spd *spd_alloc(spd_alloc294,6910
int spd_get_index(348,8171
static int user_struct_fits_on_page(356,8334
int pages_identical(366,8526
int spd_set_location(387,9133
struct spd *spd_get_by_index(spd_get_by_index422,10232
unsigned int spd_add_static_cap(434,10394
unsigned int spd_add_static_cap_extended(444,10762
struct composite_spd mpd_descriptors[mpd_descriptors514,13211
struct composite_spd *mpd_freelist;mpd_freelist515,13263
void spd_init_mpd_descriptors(517,13300
struct composite_spd *spd_mpd_by_idx(spd_mpd_by_idx542,13855
short int spd_mpd_index(549,13983
short int spd_alloc_mpd_desc(562,14313
static inline int spd_mpd_is_subordinate(612,15655
void spd_mpd_release(621,15916
static void spd_mpd_subordinate(656,16972
void spd_mpd_make_subordinate(697,18595
void spd_mpd_release_desc(721,19338
void spd_mpd_free_all(728,19458
static void spd_mpd_terminate(758,20164
static inline int spd_in_composite(779,20584
static void spd_chg_il_spd_to_all(802,20980
static void spd_chg_il_all_to_spd(835,21942
static inline void spd_add_caps(878,23112
static inline void spd_remove_caps(888,23386
static inline void spd_remove_mappings(894,23557
static inline void spd_add_mappings(901,23760
int spd_composite_add_member(917,24397
int spd_composite_remove_member(965,25781

thread.c,391
struct thread threads[threads14,280
static struct thread *thread_freelist_head thread_freelist_head15,320
struct thread *current_thread current_thread17,401
int thd_spd_in_current_composite(19,440
void thd_init_all(35,1029
struct thread *thd_alloc(thd_alloc53,1432
void thd_free(97,2400
void thd_init(125,2971
int thd_check_atomic_preempt(137,3218
void thd_print_regs(157,3646

include/asm_ipc_defs.h,319
#define IPRETURN 5,135
#define SFRAMEUSR 8,209
#define SFRAMESP 9,229
#define SFRAMEIP 10,248
#define SIZEOFUSERCAP 14,366
#define INVFN 15,391
#define ENTRYFN 16,407
#define INVOCATIONCNT 17,425
#define CAPNUM 18,449
#define INV_CAP_OFFSET 21,469
#define SAVE_REGS_CAP_OFFSET 22,500
#define RET_CAP 23,537

include/ref_count.h,72
#define REF_COUNT_H2,20
typedef unsigned short int ref_counter_t;4,41

include/thread.h,1892
#define THREAD_H9,171
struct thd_invocation_frame 32,650
struct thd_sched_info 47,1039
#define THD_STATE_PREEMPTED 54,1179
#define THD_STATE_UPCALL 55,1263
#define THD_STATE_ACTIVE_UPCALL 56,1381
#define THD_STATE_READY_UPCALL 57,1456
#define THD_STATE_BRAND 58,1547
#define THD_STATE_SCHED_RETURN 59,1622
#define THD_STATE_SCHED_EXCL 60,1719
#define THD_STATE_FAULT 63,1877
#define THD_STATE_HW_BRAND 64,1980
#define THD_STATE_CYC_CNT 65,2068
struct thread 72,2359
} CACHE_ALIGNED;112,3765
struct cos_execution_info 114,3783
static inline void thd_invocation_push(129,4162
static inline struct thd_invocation_frame *thd_invocation_pop(thd_invocation_pop154,4901
static inline struct thd_invocation_frame *thd_invstk_top(thd_invstk_top172,5557
static inline struct thd_invocation_frame *thd_invstk_nth(thd_invstk_nth182,5839
static inline struct thread *thd_get_current(thd_get_current192,6062
static inline void thd_set_current(197,6143
static inline struct spd *thd_curr_spd_noprint(thd_curr_spd_noprint204,6236
static inline struct spd *thd_get_thd_spd(thd_get_thd_spd221,6652
static inline struct spd_poly *thd_get_thd_spdpoly(thd_get_thd_spdpoly228,6799
static inline struct spd *thd_get_current_spd(thd_get_current_spd235,6973
static inline struct spd_poly *thd_get_current_spdpoly(thd_get_current_spdpoly243,7139
static inline struct thread *thd_get_by_id(thd_get_by_id253,7366
static inline struct thd_sched_info *thd_get_sched_info(thd_get_sched_info264,7570
static inline unsigned short int thd_get_depth_urg(272,7758
static inline struct spd *thd_get_depth_sched(thd_get_depth_sched285,8054
static inline int thd_scheduled_by(290,8190
static inline unsigned short int thd_get_id(295,8337
static inline struct spd *thd_validate_get_current_spd(thd_validate_get_current_spd304,8525
static inline void thd_save_preempted_state(318,8854

include/spd.h,1453
#define SPD_H9,168
#define MAX_NUM_SPDS 34,928
#define MAX_STATIC_CAP 36,1013
struct usr_inv_cap 48,1466
} HALF_CACHE_ALIGNED;51,1571
struct usr_cap_stubs 54,1635
#define CAP_FREE 60,1758
#define CAP_ALLOCATED_UNUSED 61,1780
struct invocation_cap 68,1942
} CACHE_ALIGNED;83,2544
#define SPD_COMPOSITE 102,3035
#define SPD_FREE 103,3095
#define SPD_DEPRICATED 104,3143
#define SPD_SUBORDINATE 107,3302
#define MAX_MPD_DESC 113,3668
struct spd_poly 120,3946
struct composite_spd 133,4231
} CACHE_ALIGNED;138,4464
struct spd_location 145,4684
typedef int mmaps_t;150,4757
struct spd 152,4779
} CACHE_ALIGNED;189,6031
static inline int spd_is_scheduler(212,7021
static inline int spd_is_member(217,7109
static inline int spd_is_composite(221,7238
static inline int spd_mpd_is_depricated(225,7338
static inline void spd_mpd_take(235,7626
static inline void spd_mpd_depricate(242,7837
static inline struct composite_spd *spd_alloc_mpd(spd_alloc_mpd249,8120
static inline void spd_mpd_ipc_release(253,8226
static inline void spd_mpd_ipc_take(258,8363
static inline int spd_composite_num_members(268,8723
static inline int spd_composite_move_member(286,9046
static inline int spd_composite_member(305,9525
#define SPD_CAP_TBL_PTR 315,9745
#define SPD_CAP_TBL_SZ 316,9771
#define SPD_LOWER_ADDR 317,9797
#define SPD_REGION_SIZE 318,9822
#define CAP_SIZE 321,9850
#define CAP_ENTRY_INST 322,9869
#define CAP_SPD 323,9894

include/cos_types.h,2674
#define TYPES_H9,170
typedef unsigned char u8_t;14,232
typedef unsigned short int u16_t;15,260
typedef unsigned int u32_t;16,294
typedef unsigned long long u64_t;17,322
struct shared_user_data 19,357
struct cos_sched_next_thd 26,499
#define COS_SCHED_EVT_NEXT(31,612
#define COS_SCHED_EVT_FLAGS(32,665
#define COS_SCHED_EVT_URGENCY(33,719
#define COS_SCHED_EVT_VALS(34,775
#define COS_SCHED_EVT_DISABLED_VAL 37,889
#define COS_SCHED_EVT_FREE 40,1009
#define COS_SCHED_EVT_EXCL 41,1048
#define COS_SCHED_EVT_BRAND_ACTIVE 42,1087
#define COS_SCHED_EVT_BRAND_READY 43,1126
#define COS_SCHED_EVT_NIL 44,1165
struct cos_se_values 46,1206
struct cos_sched_events 51,1292
	union next_flags_urg 52,1318
		struct compressed 54,1368
struct cos_synchronization_atom 61,1472
#define NUM_SCHED_EVTS 65,1586
struct cos_sched_data_area 67,1620
#define NULL 74,2012
struct cos_brand_info 83,2198
typedef void (*cos_net_data_completion_t)cos_net_data_completion_t87,2295
struct cos_net_callbacks 88,2350
typedef unsigned long phys_addr_t;99,2709
typedef unsigned long vaddr_t;100,2744
typedef unsigned int page_index_t;101,2775
typedef unsigned short int spdid_t;103,2811
typedef unsigned short int thdid_t;104,2847
	COS_UPCALL_BRAND_EXEC,107,2899
	COS_UPCALL_BRAND_COMPLETE,108,2923
	COS_UPCALL_BOOTSTRAP,109,2951
	COS_UPCALL_CREATE110,2974
} upcall_type_t;111,2993
	COS_BRAND_CREATE,116,3099
	COS_BRAND_ADD_THD,117,3122
	COS_BRAND_CREATE_HW,118,3142
	COS_BRAND_TAILCALL,120,3190
	COS_BRAND_ASYNC,124,3370
	COS_BRAND_UPCALL 125,3436
	COS_HW_TIMER,130,3554
	COS_HW_NET131,3569
	COS_SCHED_EVT_REGION,136,3629
	COS_SCHED_THD_EVT,137,3652
	COS_SCHED_GRANT_SCHED,138,3672
	COS_SCHED_REVOKE_SCHED139,3697
#define COS_SCHED_EXCL_YIELD 143,3759
#define COS_SCHED_TAILCALL 144,3794
#define COS_SCHED_SYNC_BLOCK 145,3829
#define COS_SCHED_SYNC_UNBLOCK 146,3864
struct mpd_split_ret 148,3900
static inline int mpd_split_error(152,3972
	COS_MPD_SPLIT,161,4172
	COS_MPD_MERGE,162,4188
	COS_MPD_SPLIT_MERGE,163,4204
	COS_MPD_DEMO,164,4226
	COS_MPD_DEBUG165,4241
	COS_MMAP_GRANT,170,4286
	COS_MMAP_REVOKE171,4303
#define IL_INV_UNMAP 174,4324
#define IL_RET_UNMAP 175,4392
#define MAX_ISOLATION_LVL_VAL 176,4455
#define IL_ST 184,4765
#define IL_SDT 185,4784
#define IL_AST 186,4827
#define IL_INV 188,4937
typedef unsigned int isolation_level_t;189,4958
#define CAP_SAVE_REGS 191,4999
typedef struct { volatile unsigned int counter; } atomic_t;197,5075
static inline void cos_ref_take(201,5161
static inline void cos_ref_set(207,5269
static inline unsigned int cos_ref_val(212,5360
static inline void cos_ref_release(217,5442

include/regs.h,27
typedef int gp_regs_t;1,0

include/ipc.h,19
#define IPC_H7,67

include/consts.h,866
#define CONSTS_H9,171
#define PAGE_SIZE 14,265
struct pt_regs 15,291
#define MAX_SERVICE_DEPTH 18,334
#define MAX_NUM_THREADS 19,363
#define MAX_SCHED_HIER_DEPTH 20,390
#define PAGE_MASK 22,422
#define PGD_RANGE 23,457
#define PGD_MASK 24,483
#define PGD_PER_PTBL 25,518
#define round_to_page(27,545
#define round_up_to_page(28,586
#define round_to_pgd_page(29,644
#define round_up_to_pgd_page(30,688
#define CACHE_LINE 32,750
#define CACHE_ALIGNED 33,774
#define HALF_CACHE_ALIGNED 34,835
#define PAGE_ALIGNED 35,903
#define SHARED_REGION_START 37,962
#define SHARED_REGION_SIZE 38,1008
#define SERVICE_START 39,1045
#define SERVICE_SIZE 41,1163
#define COS_INFO_REGION_ADDR 42,1194
#define COS_DATA_REGION_LOWER_ADDR 43,1243
#define COS_DATA_REGION_MAX_SIZE 44,1311
#define COS_NUM_ATOMIC_SECTIONS 46,1373
#define COS_MAX_MEMORY 48,1409

include/debug.h,107
#define DEBUG1,0
#define assert(5,46
#define printd(6,157
#define assert(10,273
#define printd(11,291

include/measurement.h,1300
#define MEASUREMENT_H2,22
#define MEASUREMENTS4,45
	COS_MEAS_INVOCATIONS,7,83
	COS_MEAS_UPCALLS,8,106
	COS_MEAS_SWITCH_SELF,9,125
	COS_MEAS_SWITCH_COOP,10,148
	COS_MEAS_SWITCH_PREEMPT,11,171
	COS_MEAS_INT_PREEMPT,12,197
	COS_MEAS_BRAND_UC,13,220
	COS_MEAS_BRAND_DELAYED,14,240
	COS_MEAS_BRAND_PEND,15,265
	COS_MEAS_BRAND_COMPLETION_UC,16,287
	COS_MEAS_BRAND_SCHED_PREEMPTED,17,318
	COS_MEAS_FINISHED_BRANDS,18,351
	COS_MEAS_INT_PREEMPT_USER,19,378
	COS_MEAS_INT_PREEMPT_KERN,20,406
	COS_MEAS_INT_COS_THD,21,434
	COS_MEAS_OTHER_THD,22,457
	COS_PG_FAULT,23,478
	COS_LINUX_PG_FAULT,24,493
	COS_UNKNOWN_FAULT,25,514
	COS_MPD_ALLOC,26,534
	COS_MPD_SUBORDINATE,27,550
	COS_MPD_SPLIT_REUSE,28,572
	COS_MPD_FREE,29,594
	COS_MPD_REFCNT_INC,30,609
	COS_MPD_REFCNT_DEC,31,630
	COS_MPD_IPC_REFCNT_INC,32,651
	COS_MPD_IPC_REFCNT_DEC,33,676
	COS_ALLOC_PGTBL,34,701
	COS_FREE_PGTBL,35,719
	COS_MAP_GRANT,36,736
	COS_MAP_REVOKE,37,752
	COS_MEAS_ATOMIC_RBK,38,769
	COS_MEAS_ATOMIC_STALE_LOCK,39,791
	COS_MEAS_ATOMIC_LOCK,40,820
	COS_MEAS_ATOMIC_UNLOCK,41,843
	COS_MEAS_PACKET_RECEPTION,42,868
	COS_MEAS_MAX_SIZE43,896
} cos_meas_t;44,915
static inline void cos_meas_event(51,1068
#define cos_meas_event(65,1325
#define cos_meas_init(66,1351
#define cos_meas_report(67,1375

include/mmap.h,97
#define MMAP_H9,169
struct cos_page 14,229
static inline unsigned int cos_max_mem_caps(20,330

include/page_pool.h,48
#define PAGE_POOL_H2,20
struct page_list 4,41

measurement.c,174
unsigned long long cos_measurements[cos_measurements6,81
char *cos_meas_descriptions[cos_meas_descriptions7,137
void cos_meas_init(48,1231
void cos_meas_report(59,1354

test.S,474
.globl 2,6
intermed_cap:intermed_cap3,26
.long 4,41
.globl 8,84
invokee:invokee9,99
.align 16,206
.globl 17,216
cos_intermediate:cos_intermediate18,240
after_intermed_inv:after_intermed_inv24,357
.globl 30,436
.align 31,465
SS_ipc_client_marshal:SS_ipc_client_marshal32,475
.globl 44,775
.align 45,810
SS_ipc_client_ret_unmarshal:SS_ipc_client_ret_unmarshal46,819
.globl 57,1138
.align 58,1169
SS_ipc_server_unmarshal:SS_ipc_server_unmarshal59,1179

net/cosnet.c,2151
#define DRV_NAME	54,1987
#define DRV_VERSION	55,2011
#define DRV_DESCRIPTION	56,2037
#define DRV_COPYRIGHT	57,2100
static int debug;86,2807
static const struct ethtool_ops tun_ethtool_ops;92,2906
static int tun_net_open(95,2979
static int tun_net_close(102,3092
static inline struct cosnet_struct *cosnet_find_brand(cosnet_find_brand108,3181
static struct cosnet_struct *cosnet_resolve_brand(cosnet_resolve_brand123,3486
static void cosnet_init_queues(148,4465
static void cosnet_purge_queues(160,4697
static int cosnet_queues_full(170,4899
struct tun_struct *local_ts local_ts183,5118
int cosnet_create_brand(188,5219
void cosnet_skb_completion(217,6127
int cosnet_get_packet(230,6345
struct cos_net_callbacks cosnet_cbs 268,7395
static int cosnet_cos_register(273,7510
static int cosnet_cos_deregister(280,7597
static int cosnet_execute_brand(291,7816
static int tun_net_xmit(298,8024
add_multi(346,9201
del_multi(354,9420
tun_net_mclist(364,9752
static struct net_device_stats *tun_net_stats(tun_net_stats382,10386
static void tun_net_init(389,10555
static unsigned int tun_chr_poll(423,11418
static __inline__ ssize_t tun_get_user(442,11833
static inline size_t iov_total(495,12968
static ssize_t tun_chr_aio_write(506,13157
static __inline__ ssize_t tun_put_user(520,13546
static ssize_t tun_chr_aio_read(552,14186
static void tun_setup(635,16516
static struct tun_struct *tun_get_by_name(tun_get_by_name654,16952
static int tun_set_iff(667,17192
static int tun_chr_ioctl(761,19112
static int tun_chr_fasync(913,23149
static int tun_chr_open(937,23616
static int tun_chr_close(945,23790
static const struct file_operations tun_fops 979,24378
static struct miscdevice tun_miscdev 993,24728
static int tun_get_settings(1001,24897
static void tun_get_drvinfo(1016,25246
static u32 tun_get_msglevel(1034,25649
static void tun_set_msglevel(1044,25821
static u32 tun_get_link(1052,25979
static u32 tun_get_rx_csum(1058,26099
static int tun_set_rx_csum(1064,26243
static const struct ethtool_ops tun_ethtool_ops 1074,26446
static int __init tun_init(1084,26732
static void tun_cleanup(1097,27028

net/if_cosnet.h,871
#define __IF_COSNET_H19,702
#define TUN_DEBUG 22,761
#define DBG 27,818
#define DBG1 28,852
#define DBG(30,890
#define DBG1(31,910
#define COSNET_NUM_CHANNELS 37,1005
#define COSNET_QUEUE_LEN 38,1035
struct cosnet_struct 40,1065
struct tun_struct 45,1165
#define TUN_READQ_SIZE	74,1661
#define TUN_TUN_DEV 77,1713
#define TUN_TAP_DEV	78,1742
#define TUN_TYPE_MASK 79,1769
#define TUN_FASYNC	81,1801
#define TUN_NOCHECKSUM	82,1827
#define TUN_NO_PI	83,1857
#define TUN_ONE_QUEUE	84,1882
#define TUN_PERSIST 85,1911
#define TUNSETNOCSUM 88,1961
#define TUNSETDEBUG 89,2004
#define TUNSETIFF 90,2047
#define TUNSETPERSIST 91,2090
#define TUNSETOWNER 92,2133
#define TUNSETLINK 93,2175
#define IFF_TUN	96,2244
#define IFF_TAP	97,2268
#define IFF_NO_PI	98,2292
#define IFF_ONE_QUEUE	99,2317
struct tun_pi 101,2347
#define TUN_PKT_STRIP	105,2412

net/util/cnet_user.c,112
#define DEVCNET 14,240
#define ETHCNET 15,272
#define IPADDR 16,296
#define P2PPEER 17,323
int main(19,351

net/util/udp_client.c,173
#define rdtscll(15,254
void construct_header(18,329
unsigned int msg_sent 33,606
void signal_handler(34,633
void start_timers(40,737
int foo 67,1204
int main(69,1218

test.c,298
#define rdtscll(5,44
#define ITERATIONS 8,117
void print(11,158
int print_val(17,223
extern unsigned int SS_ipc_client_marshal(28,385
int c_invokee(31,510
int invoker(37,577
int ucap_tbl1[ucap_tbl166,1275
int ucap_tbl2[ucap_tbl267,1294
int ucap_tbl3[ucap_tbl368,1313
int main(70,1333

offset_gen.c,15
int main(8,95

page_pool.c,190
struct page_list page_list_head;10,238
unsigned int page_list_len 11,271
struct page_list *cos_get_pg_pool(cos_get_pg_pool17,397
void cos_put_pg_pool(41,899
void clear_pg_pool(55,1188

mmap.c,183
static struct cos_page cos_pages[cos_pages10,181
void cos_init_memory(17,374
void cos_shutdown_memory(28,496
int cos_phys_addr_to_cap(47,892
phys_addr_t cos_access_page(60,1057
